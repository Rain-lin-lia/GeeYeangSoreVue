export function useMessageLabel() {
  const labelRules = [
    { keywords: ['有空', '方便', '時間', '空檔'], label: '詢問空檔' },
    { keywords: ['還有', '在嗎', '租出去', '剩下'], label: '詢問房源' },
    { keywords: ['降價', '便宜', '再低', '可議'], label: '詢問價格' },
    { keywords: ['看房', '安排', '參觀', '現場'], label: '預約看房' },
    { keywords: ['地址', '地點', '位置'], label: '詢問位置' },
    { keywords: ['更多照片'], label: '詢問照片' },
    { keywords: ['設備', '傢俱', '洗衣機', '冰箱'], label: '詢問設備' },
    { keywords: ['停車', '車位'], label: '詢問車位' },
    { keywords: ['租約', '期限', '幾個月', '短租'], label: '詢問租期' },
    { keywords: ['包水電', '含水電', '電費'], label: '詢問費用' },
    { keywords: ['寵物', '養寵物', '貓', '狗'], label: '詢問寵物' },
    { keywords: ['網路', 'wifi', '電視'], label: '詢問網路' },
  ];

  const badWords = [
    '三級片', '下三爛', '下賤', '乳交', '乳頭', '乳房', '乳波臀浪', '交配', '仆街', '他媽ㄉ王八蛋', '他媽地', '他馬的', '你個傻比', '你他馬的', '你她馬的', '你娘卡好', '你娘咧', '做愛', '傻比', '傻逼', '冊那', '軍妓', '幾八', '幾叭', '幾巴', '幾芭', '剛度', '剛癟三', '包皮', '十三點', '賣B', '賣比', '賣淫', '卵', '卵子', '雙峰微顫', '口交', '口肯', '叫床', '吃屎', '外陰', '大卵子', '大卵泡', '大雞巴', '奶子', '奸', '奸你', '她媽地', '她媽的', '她馬的', '媽B', '媽個B', '媽個比', '媽個老比', '媽比', '媽的B', '媽逼', '妓', '妓女', '妓院', '妳她媽的', '妳媽的', '妳娘的', '妳老母的', '妳馬的', '姘頭', '姣西', '姦', '娘個比', '娘的', '婊子', '婊子養的', '嫖娼', '嫖客', '它媽地', '它媽的', '密洞', '射你', '射精', '乳頭', '小卵子', '小卵泡', '小癟三', '小肉粒', '小騷比', '小騷貨', '小雞巴', '小雞雞', '屁眼', '屁股', '屄', '屌', '巨乳', '幹x娘', '幹七八', '幹你', '幹你媽', '幹你娘', '幹你老母', '幹你良', '幹妳媽', '幹妳娘', '幹妳老母', '幹妳馬', '幹您娘', '幹機掰', '幹死CS', '幹死GM', '幹死你', '幹死客服', '強奸', '強奸你', '性', '性交', '性器', '性無能', '性愛', '情色', '想上你', '懆您媽', '懆您娘', '懶8', '懶八', '懶叫', '懶教', '我操你祖宗十八代', '扒光', '打炮', '打飛機', '抽插', '招妓', '插你', '插死你', '撒尿', '操你', '操你全家', '操你奶奶', '操你媽', '操你娘', '操你祖宗', '操你老媽', '操你老母', '操妳', '操妳全家', '操妳媽', '操妳娘', '操妳祖宗', '操機掰', '操比', '操逼', '放蕩', '日他娘', '日你', '日你媽', '日你老娘', '日你老母', '日批', '機八', '機巴', '雜種', '浪叫', '淫', '淫亂', '淫婦', '淫棍', '淫水', '淫穢', '淫蕩', '淫西', '激情', '爛貨', '爛逼', '爛', '狗屁', '狗日', '狗狼養的', '玉杵', '王八蛋', '白爛', '白癡', '祖宗', '笨蛋', '精子', '老味', '老騷比', '老騷貨', '肉壁', '肉棍子', '肉棒', '肉縫', '肏', '肛交', '色情', '蕩婦', '賤', '貝肉', '賤B', '賤人', '賤貨', '賊你媽', '賽你老母', '賽妳阿母', '幹您娘', '輪奸', '迷藥', '逼樣', '陽具', '陽萎', '陰唇', '陰戶', '陰核', '陰毛', '陰莖', '陰道', '陰部', '雞巴', '靠北', '靠腰', '騷比', '騷貨', '騷逼', '雞8', '雞八', '雞叭', '雞吧', '雞奸', '雞巴', '雞芭', '雞雞', '龜兒子', '龜頭', '陰莖', '㞗', '尻', '笨實', '屎忽', '躝癱',
    '幹', '操', '他媽', '你媽', '媽的', '靠北', '靠夭',
    '死', '垃圾', '白癡', '智障', '腦殘', '腦袋壞掉',
    '王八', '低能', '機掰', '屁', '婊子', '賤人',
    '雞掰', '雞巴', '去死', '你娘', '王八蛋', '死好',
    '智障', '欠揍', '北七', '腦包', '滾', '廢物',
    '豬頭', '敗類', '操你', '媽寶', '智障',
  ];

  function getLabelFromMessage(message: string): string {
    const text = message?.toLowerCase() || '';
    for (const rule of labelRules) {
      if (rule.keywords.some(keyword => text.includes(keyword))) {
        return rule.label;
      }
    }
    return '';
  }
  function getWarningLabel(message: string): string {
    const text = message?.toLowerCase() || '';
    return badWords.some(word => text.includes(word)) ? ' 可疑言論' : '';
  }
  function filterBadWords(message = ''): string {
    let filtered = message;
    for (const word of badWords) {
      if (!word) continue;
      // 全域不分大小寫替換
      const re = new RegExp(word.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'), 'gi');
      filtered = filtered.replace(re, '***');
    }
    return filtered;
  }
  return {
    getLabelFromMessage,
    getWarningLabel,
    filterBadWords
  };
}